https://www.cnblogs.com/muchen/p/5305658.html
https://mp.weixin.qq.com/s?__biz=MzIwNjM0MTc0Ng==&mid=2247483925&idx=1&sn=3d08b1b7cae955ebd20585994f058791&chksm=97225108a055d81ec6263f71c81fc9c3e000347696905bd2ac802e30cdb5b46d87ab477f3749&token=495211332&lang=zh_CN&scene=21#wechat_redirect
数据仓库基本概念:
    业务板块：
         比数据域更高维度的业务划分方法，适用于庞大的业务系统。
    维度：
         维度建模由Ralph Kimball提出。维度模型主张从分析决策的需求出发构建模型，为分析需求服务。
         维度是度量的环境，是我们观察业务的角度，用来反映业务的一类属性。
         属性的集合构成维度，也可以称为实体对象。
         例如，在分析交易过程时，可以通过买家、卖家、商品和时间等维度描述交易发生的环境。
    属性（维度属性）：
         维度所包含的表示维度的列称为维度属性。
         维度属性是查询约束条件、分组和报表标签生成的基本来源，是数据易用性的关键。
    度量：
         在维度建模中，将度量称为事实，将环境描述为维度，维度是用于分析事实所需要的多样环境。
         度量通常为数值型数据，作为事实逻辑表的事实。
    指标：
         指标分为原子指标和派生指标以及衍生指标。
         原子指标是基于某一业务事件行为下的度量，是业务定义中不可再拆分的指标，是具有明确业务含义的名词 ，体现明确的业务统计口径和计算逻辑，例如支付金额。
    原子指标=业务过程+度量。
    派生指标=时间周期+修饰词+原子指标，派生指标可以理解为对原子指标业务统计范围的圈定。
    业务限定：统计的业务范围，筛选出符合业务规则的记录（类似于SQL中where后的条件，不包括时间区间）。
    统计周期：统计的时间范围，例如最近一天，最近30天等（类似于SQL中where后的时间条件）。
    统计粒度：统计分析的对象或视角，定义数据需要汇总的程度，可理解为聚合运算时的分组条件（类似于SQL中的group by的对象）。粒度是维度的一个组合，指明您的统计范围。例如，某个指标是某个卖家在某个省份的成交额，则粒度就是卖家、地区这两个维度的组合。如果您需要统计全表的数据，则粒度为全表。在指定粒度时，您需要充分考虑到业务和维度的关系。统计粒度常作为派生指标的修饰词而存在。



数据仓库分层：
    在阿里巴巴的数据体系中，我们建议将数据仓库分为三层，自下而上为：
    数据引入层（ODS，Operation Data Store）、
    数据公共层（CDM，Common Data Model）
    和数据应用层（ADS，Application Data Service）。
    和维度逻辑表通常一一对应。
    ODS:
        数据引入层ODS（Operation Data Store）：存放未经过处理的原始数据至数据仓库系统，结构上与源系统保持一致，是数据仓库的数据准备区。主要完成基础数据引入到MaxCompute的职责，同时记录基础数据的历史变化。
    CDM:
        数据公共层CDM（Common Data Model，又称通用数据模型层），包括DIM维度表、DWD和DWS，由ODS层数据加工而成。主要完成数据加工与整合，建立一致性的维度，构建可复用的面向分析和统计的明细事实表，以及汇总公共粒度的指标。
        DWS:
            公共汇总粒度事实层（DWS）：以分析的主题对象作为建模驱动，基于上层的应用和产品的指标需求，构建公共粒度的汇总指标事实表，以宽表化手段物理化模型。构建命名规范、口径一致的统计指标，为上层提供公共指标，建立汇总宽表、明细事实表。
            公共汇总粒度事实层的表通常也被称为汇总逻辑表，用于存放派生指标数据。
        DWD:
            明细粒度事实层（DWD）：以业务过程作为建模驱动，基于每个具体的业务过程特点，构建最细粒度的明细层事实表。
            可以结合企业的数据使用特点，将明细事实表的某些重要维度属性字段做适当冗余，即宽表化处理。
            明细粒度事实层的表通常也被称为逻辑事实表。
    ADS:
        数据应用层ADS（Application Data Service）
        存放数据产品个性化的统计指标数据。根据CDM与ODS层加工生成。


数据仓库的特点：
        1. 面向主题
        面向主题特性是数据仓库和操作型数据库的根本区别。
        操作型数据库是为了支撑各种业务而建立
        而分析型数据库则是为了对从各种繁杂业务中抽象出来的分析主题(如用户、成本、商品等)进行分析而建立；
        2. 集成性
        集成性是指数据仓库会将不同源数据库中的数据汇总到一起；
        3. 企业范围
        数据仓库内的数据是面向公司全局的。比如某个主题域为成本，则全公司和成本有关的信息都会被汇集进来；
        4. 历史性
        较之操作型数据库，数据仓库的时间跨度通常比较长。前者通常保存几个月，后者可能几年甚至几十年；
        5. 时变性
        时变性是指数据仓库包含来自其时间范围不同时间段的数据快照。有了这些数据快照以后，用户便可将其汇总，生成各历史阶段的数据分析报告；


   2.维度建模(dimensional modeling)是专门用于分析型数据库、数据仓库、数据集市建模的方法。

        它本身属于一种关系建模方法，但和之前在操作型数据库中介绍的关系建模方法相比增加了两个概念：

        1. 维度表(dimension)
        表示对分析主题所属类型的描述。比如"昨天早上张三在京东花费200元购买了一个皮包"。
        那么以购买为主题进行分析，可从这段信息中提取三个维度：时间维度(昨天早上)，地点维度(京东), 商品维度(皮包)。
        通常来说维度表信息比较固定，且数据量小。

        2. 事实表(fact table)
        表示对分析主题的度量。比如上面那个例子中，200元就是事实信息。
        事实表包含了与各维度表相关联的外码，并通过JOIN方式与维度表关联。
        事实表的度量通常是数值类型，且记录数会不断增加，表规模迅速增长。
        注：在数据仓库中不需要严格遵守规范化设计原则(具体原因请看上篇)。

数仓建模：
    数仓建模的过程分为业务建模、领域建模、逻辑建模和物理建模，但是这些步骤比较抽象。
    为了便于落地，我根据自己的经验，总结出上面的七个步骤：
      梳理业务流程、垂直切分、指标体系梳理、实体关系调研、维度梳理、数仓分层以及物理模型建立。
    1、业务流程：
      找到公司核心业务流程，找到谁，在什么环节，做什么关键动作，得到什么结果。
    2、垂直切分
      决定数仓的建设方式，快速交活，就用自下而上的建设。要全面支撑，就顶层规划，分步实施，交活稍微慢点。
      同时按照业务领域划分主题域。
      主题域的划分方法有：按业务流划分（推荐）、按需求分、按职责分、按产品功能分等。
    3、指标体系：
       指标可分为原子指标、派生指标和衍生指标，其含义及命名规则举例如下：
       原生指标：业务流修饰+基础度量词根，如支付（业务流）+ 金额（度量值）：order_amt
       派生指标：日期修饰+业务限定+聚合修饰+原生指标，如近七天（业务流修饰）+ 使用红包（业务限定）+ 累计(聚合) + 支付金额（原生指标）：7d_hongbao_order_sum
       衍生指标：日期修饰+业务限定+聚合修饰+原生指标+业务目标，如近七天（业务流修饰）+ 使用红包（业务限定）+ 累计(聚合) + 支付金额（原生指标）占总支付金额的占比：7d_hongbao_order_sum_rate
       依照指标体系建设标准，开始梳理指标体系。
       整个体系同样要以业务为核心进行梳理。
       同时梳理每个业务过程所需的维度。
       维度就是你观察这个业务的角度，指标就是衡量这个业务结果好坏的量化结果。
       请注意，此时不能被现有数据局限。如果分析出这个业务过程应该有这个指标，但是没有数据，请标注出来，提出收集数据的需求。
    4、实体关系
       每个业务动作都会有数据产生。我们将能够获取到的数据，提取实体，绘制ER图，便于之后的维度建模。
       同样以业务过程为起点向下梳理，此时的核心是业务表。把每张表中涉及的维度、指标都整理出来。
    5、维度整理
      维度标准化是将各个业务系统中相同的维度进行统一的过程。
      其字段名称、代码、名字都可能不一样，我们需要完全掌握，并标准化。
    6、数据仓库一般分为4层，名字可能会不一样，但是其目的和建设方法基本一致：
      每一层采用的建模方法都不一样，其核心是逐层解耦。越到底层，越接近业务发生的记录，越到上层，越接近业务目标。
    7、数仓分层
      依托数仓分层的设计理论，根据实际业务场景，我们就可以梳理出整体的数据流向图。这张图会很清晰的告诉所有人，数据从那来，到哪里去，最终提供什么样的服务。
      DWS:服务数据层(service),
      DWB:基础数据层(base)，按照维度建模的原理，将数据拆分成维度和事实，进行维度、事实的统一。对数据进行轻度汇总，形成指标结果。
      DWD:明细数据层(detail)，对数据进行清理，代码统一，字段统一，格式统一等工作，目的是标准化，给后续的处理提供干净统一标准的数据
      ODS:操作数据层，原始数据层，与业务系统基本同构，目的是保留历史，解耦业务数据库
    8、物理建模
      此时才真正进入纯代码阶段。
      数仓、ETL工具选型；ETL流程开发；cube的建立；
      任务调度，设定更新方式、更新频率；
      每日查看日志、监控etl执行情况等等。

维度建模：
    维度模型中，一般分为两种：星型模型和雪花模型，再往上就是CUBE。